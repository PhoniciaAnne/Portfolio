import{w as v}from"./tsparticles-engine-4f96873b.js";const w=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d.]+%?\))|currentcolor/gi;function p(a,r,e){const{svgData:o}=a;if(!o)return"";const t=v(r,e);if(o.includes("fill"))return o.replace(w,()=>t);const s=o.indexOf(">");return`${o.substring(0,s)} fill="${t}"${o.substring(s)}`}async function h(a){return new Promise(r=>{a.loading=!0;const e=new Image;a.element=e,e.addEventListener("load",()=>{a.loading=!1,r()}),e.addEventListener("error",()=>{a.element=void 0,a.error=!0,a.loading=!1,console.error(`Error tsParticles - loading image: ${a.source}`),r()}),e.src=a.source})}async function I(a){if(a.type!=="svg"){await h(a);return}a.loading=!0;const r=await fetch(a.source);r.ok||(console.error("Error tsParticles - Image not found"),a.error=!0),a.error||(a.svgData=await r.text()),a.loading=!1}function b(a,r,e,o){var t,s,n;const d=p(a,e,(s=(t=o.opacity)===null||t===void 0?void 0:t.value)!==null&&s!==void 0?s:1),l={color:e,data:Object.assign(Object.assign({},a),{svgData:d}),loaded:!1,ratio:r.width/r.height,replaceColor:(n=r.replaceColor)!==null&&n!==void 0?n:r.replace_color,source:r.src};return new Promise(i=>{const m=new Blob([d],{type:"image/svg+xml"}),c=URL||window.URL||window.webkitURL||window,f=c.createObjectURL(m),g=new Image;g.addEventListener("load",()=>{l.loaded=!0,l.element=g,i(l),c.revokeObjectURL(f)}),g.addEventListener("error",async()=>{c.revokeObjectURL(f);const u=Object.assign(Object.assign({},a),{error:!1,loading:!0});await h(u),l.loaded=!0,l.element=u.element,i(l)}),g.src=f})}class y{constructor(){this._images=[]}addImage(r,e){const o=this.getImages(r);o==null||o.images.push(e)}destroy(){this._images=[]}draw(r,e,o,t){var s;const n=e.image,d=n==null?void 0:n.element;if(!d)return;const l=(s=n==null?void 0:n.ratio)!==null&&s!==void 0?s:1,i={x:-o,y:-o};r.globalAlpha=t,r.drawImage(d,i.x,i.y,o*2,o*2/l),r.globalAlpha=1}getImages(r){const e=this._images.find(o=>o.id===r.id);return e||(this._images.push({id:r.id,images:[]}),this.getImages(r))}getSidesCount(){return 12}loadShape(r){if(r.shape!=="image"&&r.shape!=="images")return;const e=r.container,o=this.getImages(e).images,t=r.shapeData;o.find(n=>n.source===t.src)||this.loadImageShape(e,t).then(()=>{this.loadShape(r)})}particleInit(r,e){var o;if(e.shape!=="image"&&e.shape!=="images")return;const t=this.getImages(r).images,s=e.shapeData,n=e.getFillColor(),d=(o=s.replaceColor)!==null&&o!==void 0?o:s.replace_color,l=t.find(i=>i.source===s.src);if(l){if(l.loading){setTimeout(()=>{this.particleInit(r,e)});return}(async()=>{var i,m;let c;l.svgData&&n?c=await b(l,s,n,e):c={color:n,data:l,element:l.element,loaded:!0,ratio:s.width/s.height,replaceColor:d,source:s.src},c.ratio||(c.ratio=1);const f=(i=s.fill)!==null&&i!==void 0?i:e.fill,g=(m=s.close)!==null&&m!==void 0?m:e.close,u={image:c,fill:f,close:g};e.image=u.image,e.fill=u.fill,e.close=u.close})()}}async loadImageShape(r,e){var o;const t=e.src;if(!t)throw new Error("Error tsParticles - No image.src");try{const s={source:t,type:t.substring(t.length-3),error:!1,loading:!0};this.addImage(r,s),await(((o=e.replaceColor)!==null&&o!==void 0?o:e.replace_color)?I:h)(s)}catch{throw new Error(`tsParticles error - ${e.src} not found`)}}}async function C(a){await a.addShape(["image","images"],new y)}export{C as l};
